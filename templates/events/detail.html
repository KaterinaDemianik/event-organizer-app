{% extends "base.html" %}
{% block title %}{{ event.title }} ¬∑ Event Organizer{% endblock %}
{% block content %}
  <article class="card">
    <header class="card-head">
      <div class="card-title">
        <h1 style="margin:0;">{{ event.title }}</h1>
        <span class="badge {{ event.status }}">{{ event.get_status_display }}</span>
      </div>
    </header>
    
    <div class="event-meta" style="margin:16px 0;">
      <span>üìÖ {{ event.starts_at|date:"d.m.Y H:i" }} ‚Üí {{ event.ends_at|date:"d.m.Y H:i" }}</span>
      <span>üìç {{ event.location }}</span>
      <span>üë§ –û—Ä–≥–∞–Ω—ñ–∑–∞—Ç–æ—Ä: {{ event.organizer.username }}</span>
    </div>
    
    {% if event.status == 'cancelled' %}
      <div class="flash warning" style="margin:16px 0;">
        <strong>‚ö†Ô∏è –ü–æ–¥—ñ—é —Å–∫–∞—Å–æ–≤–∞–Ω–æ</strong><br>
        –¶—è –ø–æ–¥—ñ—è –±—É–ª–∞ —Å–∫–∞—Å–æ–≤–∞–Ω–∞ –æ—Ä–≥–∞–Ω—ñ–∑–∞—Ç–æ—Ä–æ–º.
      </div>
    {% endif %}
    
    <p style="margin:16px 0;">{{ event.description|linebreaksbr }}</p>
    
    <div class="event-actions">
      {% if user.is_authenticated and event.organizer == user %}
        <!-- –û—Ä–≥–∞–Ω—ñ–∑–∞—Ç–æ—Ä –±–∞—á–∏—Ç—å –∫–Ω–æ–ø–∫–∏ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ç–∞ —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è -->
        <a role="button" href="/events/{{ event.id }}/edit/">‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –ø–æ–¥—ñ—é</a>
        {% if event.status != 'cancelled' %}
          <form method="post" action="/events/{{ event.id }}/cancel/" style="display:inline; margin:0;" onsubmit="return confirm('–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ —Å–∫–∞—Å—É–≤–∞—Ç–∏ —Ü—é –ø–æ–¥—ñ—é?');">
            {% csrf_token %}
            <button type="submit" class="outline" style="background:#dc3545; border-color:#dc3545; color:#fff;">üö´ –°–∫–∞—Å—É–≤–∞—Ç–∏ –ø–æ–¥—ñ—é</button>
          </form>
        {% endif %}
        <a role="button" class="outline" href="/">‚Üê –ù–∞–∑–∞–¥</a>
      {% elif user.is_authenticated %}
        <!-- –ó–≤–∏—á–∞–π–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –±–∞—á–∞—Ç—å RSVP -->
        {% if event.status == 'cancelled' %}
          <p style="color: var(--muted);">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ - –ø–æ–¥—ñ—é —Å–∫–∞—Å–æ–≤–∞–Ω–æ</p>
        {% elif user_rsvp %}
          <button disabled class="rsvp-registered">‚úì –í–∏ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω—ñ</button>
          <form method="post" action="/events/{{ event.id }}/rsvp/cancel/" style="display:inline; margin:0;">
            {% csrf_token %}
            <button type="submit" class="outline">–°–∫–∞—Å—É–≤–∞—Ç–∏ —É—á–∞—Å—Ç—å</button>
          </form>
        {% else %}
          <a role="button" href="/events/{{ event.id }}/rsvp/">üìù –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏—Å—è</a>
        {% endif %}
        <a role="button" class="outline" href="/">‚Üê –ù–∞–∑–∞–¥</a>
      {% else %}
        <!-- –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ -->
        <a role="button" href="/accounts/login/?next=/events/{{ event.id }}/">–£–≤—ñ–π—Ç–∏ –¥–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó</a>
        <a role="button" class="outline" href="/">‚Üê –ù–∞–∑–∞–¥</a>
      {% endif %}
    </div>
  </article>
{% endblock %}
